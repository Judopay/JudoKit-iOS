default_platform(:ios)

platform :ios do
  before_all do
    setup_circle_ci
    en_ci_utils_init
  end

  desc "Build and run tests"
  lane :test do
    scan
  end

  desc "Ad-hoc build"
  lane :adhoc do
    match(type: "adhoc")
    gym(export_method: "ad-hoc")
  end
  
  lane :generate_code_quality_reports do
    sh("cd .. && ./clang-format.sh lint") # check code format
    scan(use_clang_report_name: true)     # run tests and generate reports
    oclint(report_type: 'html')           # run static code analyzer
    slather                               # generate code coverage reports
  end

end